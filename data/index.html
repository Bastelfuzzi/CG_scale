<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="M. Lehmann">
    <title>CG scale by M. Lehmann</title>
    <link href="/bootstrap.min.css" rel="stylesheet">
    <script src="/bootstrap.min.js"></script>
    <script>
        var CG_trans_visible = true;
        var batVolt_visible = true;
        function getHead(){
            var request = new XMLHttpRequest();
            request.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    if(this.responseText != null){
                        var responseString = this.responseText;
                        var value = responseString.split("&");
                        document.getElementById("ssid").innerHTML = value[0];
                        document.getElementById("errMsg").innerHTML = value[1];
                        document.getElementById("cgscaleVersion").innerHTML = value[2];
                    }
                }
            }
            request.open("GET", "getHead", true);
            request.send();
        }
        function getParameter(){
            var request = new XMLHttpRequest();
            request.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    if(this.responseText != null){
                        var responseString = this.responseText;
                        var value = responseString.split("&");
                        if(value[0] == "2"){
                            CG_trans_visible = false;
                            document.getElementById("cglrContainer").outerHTML = "";
                        }
                        if(value[11] == "OFF"){
                            batVolt_visible = false;
                            document.getElementById("batContainer").outerHTML = "";
                        }
                    }
                }
            }
            request.open("GET", "getParameter", true);
            request.send();
        }
        function getValue(){
            var request = new XMLHttpRequest();
            request.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    if(this.responseText != null){
                        var responseString = this.responseText;
                        var value = responseString.split("&");
                        document.getElementById("weightTotal").innerHTML = value[0];
                        document.getElementById("CG_length").innerHTML = value[1];
                        if(CG_trans_visible == true){
                            document.getElementById("CG_trans").innerHTML = value[2];
                        }
                        if(batVolt_visible == true){
                            document.getElementById("batVolt").innerHTML = value[3];
                        }
                    }
                }
            }
            request.open("GET", "getValue", true);
            request.send();
            setTimeout('getValue()', 1000);
        }
    </script>
</head>
<body onload=getValue()>
    <script>        
        getHead();
        getParameter();
    </script>
    <nav class="navbar navbar-dark fixed-top bg-dark">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#"><span id="ssid"></span></a>"
            </div>
            <ul class="nav navbar-nav navbar-right">
                <button type="button" onclick="location.href = '/settings.html'" class="btn btn-danger">
                    <img src="settings.png" alt="" style="width:auto;height:30px">
                </button>
            </ul>
        </div>
    </nav>
    <br><br><br>
    <main role="main" class="container">
        <div class="jumbotron">
            <div class="container" id="wgContainer">
                <div class="row mt-3">
                    <div class="col-xs-6"><img src="weight.png" class="pull-left mr-4" alt="Weight" style="width:auto;height:50px"></div>
                    <div class="col-xs-6 d-flex align-items-center"><font size="6"><span id="weightTotal">-</span></font></div>
                </div>
            </div>
            <div class="container" id="cgContainer">
                <div class="row mt-3">
                    <div class="col-xs-6"><img src="cg.png" class="pull-left mr-4" alt="CG" style="width:auto;height:50px"></div>
                    <div class="col-xs-6 d-flex align-items-center"><font size="6"><span id="CG_length">-</span></font></div>
                </div>
            </div> 
            <div class="container" id="cglrContainer">
                <div class="row mt-3">
                    <div class="col-xs-6"><img src="cglr.png" class="pull-left mr-4" alt="CG left/right" style="width:auto;height:50px"></div>
                    <div class="col-xs-6 d-flex align-items-center"><font size="6"><span id="CG_trans">-</span></font></div>
                </div>
            </div> 
            <div class="container" id="batContainer">
                <div class="row mt-3">
                    <div class="col-xs-6"><img src="battery.png" class="pull-left mr-4" alt="Battery" style="width:auto;height:50px"></div>
                    <div class="col-xs-6 d-flex align-items-center"><font size="6"><span id="batVolt">-</span></font></div>
                </div>
            </div>
            <div class="container"><font size="6"><span id="errMsg"></span></font></div>
        </div>
    </main>
    <p><font size="2"><center>(c) 2019 M. Lehmann - Version: <span id="cgscaleVersion">0.0</span></center></font></p>
</body>
</html>